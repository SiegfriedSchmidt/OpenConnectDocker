services:
  ocserv:
    platform: linux/amd64
    build: .
    image: siegfriedschmidt/ocserv
    container_name: ocserv
    ports:
      - "8443:443"
    environment:
      # true value executes "network-manager.sh enable" to forward the vpn subnet to the external interface (default eth0)
      - FORWARD_TO_EXTERNAL_INTERFACE=true
    volumes:
      - ./ocserv.conf:/ocserv.conf:ro
      - ./data:/etc/ocserv
    devices:
      - /dev/net/tun:/dev/net/tun
    cap_add:
      - NET_ADMIN
    sysctls:
      - net.ipv4.ip_forward=1
    security_opt:
      - no-new-privileges:true
    restart: "no"
